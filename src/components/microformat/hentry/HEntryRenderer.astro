---
import { discoverPostType, getExtractorForType } from '~/lib/discovery'
import HEntryMinimal from './minimal/HEntryMinimal.astro'
import HEntryPreview from './preview/HEntryPreview.astro'
import HEntryPermalink from './permalink/HEntryPermalink.astro'
import { DocumentRenderProps, RenderMethod } from '~/types/mf2-rendering'

export interface Props extends DocumentRenderProps {}

const { doc, renderMethod = RenderMethod.Full, class: className } = Astro.props as DocumentRenderProps

const type = discoverPostType(doc.properties)
const extractor = getExtractorForType(type, doc.properties)
---

{(() => {
    switch (renderMethod) {
        case RenderMethod.Minimal:
             return (
                <HEntryMinimal extractor={extractor} class={className} />
            )
        case RenderMethod.Preview:
            return (
                <HEntryPreview extractor={extractor} class={className} />
            )
        case RenderMethod.Full:
            return (
                <HEntryPermalink extractor={extractor} class={className} />
            )
    }
})()}