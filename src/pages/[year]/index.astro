---
import HFeedRenderer from "~/components/microformat/hfeed/HFeedRenderer.astro";
import BaseLayout from "~/layouts/BaseLayout.astro";
import { QueryParams, queryPosts } from "~/lib/scribble/scribble";
import { validateYearForPath } from "~/util/url";

const { year } = Astro.params;
if (!validateYearForPath(year)) {
    return new Response(null, { status: 404 });
}

const queryParams: QueryParams = {
    type: "h-entry",
    year: Number(year!),
};

const results = await queryPosts(queryParams);
const title = `Posts from ${year}`;
---

<BaseLayout title={`Posts from ${year}`}>
    <HFeedRenderer posts={results} feedInfo={{ title, url: `/${year}` }} />
</BaseLayout>
